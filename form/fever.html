<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fever Clerking Sheet</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="../css/styles.css" />
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f8f9fa;
      }

      #result {
        margin-top: 20px;
        padding: 10px;
        background-color: #f2f2f2;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      .detail-input {
        margin-top: -10px;
        font-size: 0.875rem; /* Reduce font size */
        height: auto; /* Adjust height to auto */
      }

      #resultFBC {
        margin-top: 20px;
        padding: 10px;
        background-color: #f2f2f2;
        border: 1px solid #ccc;
        border-radius: 5px;
      }

      #resultVC {
        margin-top: 20px;
        padding: 10px;
        background-color: #f2f2f2;
        border: 1px solid #ccc;
        border-radius: 5px;
      }

      .out-of-range {
        color: red;
        font-weight: bold;
      }

      .within-range {
        color: green;
        font-weight: bold;
      }

      .invalid-feedback {
        color: red;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="../form/diabetes.html">Diabetes Follow Up</a></li>
        <li><a href="../form/asthmaFollowUp.html">Asthma Follow Up</a></li>
        <li><a href="../form/hypertension.html">HTN Follow Up</a></li>
        <li><a href="../form/ams.html">AMS</a></li>
        <li><a href="../form/pain.html">Pain Clinic</a></li>
        <li><a href="../form/ppc.html">Pre Pregnancy Care</a></li>
        <li><a href="../form/paedCal.html">Paed Dosage Calculator</a></li>
      </ul>
    </nav>

    <h1>Fever Clerking Sheet</h1>
    <form id="fever-clerking-form">
      <div class="form-group">
        <label for="chiefComplaint">Chief complaint:</label>
        <textarea id="chiefComplaint" name="chiefComplaint"></textarea>
      </div>

      <div class="form-group">
        <label for="coMorbidity">Co-morbidity:</label>
        <textarea id="coMorbidity" name="coMorbidity"></textarea>
      </div>

      <div class="form-group">
        <label for="travelHistory">Travel History:</label>
        <textarea id="travelHistory" name="travelHistory"></textarea>
      </div>

      <div class="form-group">
        <label for="weight">Weight:</label>
        <input type="text" class="form-control" id="weight" name="weight" />
      </div>

      <div class="form-group">
        <label for="height">Height:</label>
        <input type="text" class="form-control" id="height" name="height" />
      </div>

      <div class="form-group">
        <label for="dateOfFeverOnset">Date of fever onset:</label>
        <input
          type="date"
          class="form-control"
          id="dateOfFeverOnset"
          name="dateOfFeverOnset"
        />
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label for="previousDengueHistory"
            >Previous history of dengue illness:</label
          >
          <input
            type="text"
            class="form-control detail-input col-12"
            id="previousDengueHistoryDetail"
            name="previousDengueHistoryDetail"
            placeholder="If yes, please provide details"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="previousDengueHistory" value="Yes" />
            Yes</label
          >
          <label class="btn btn-secondary">
            <input
              type="radio"
              name="previousDengueHistory"
              value="No"
              id="6"
            />
            No</label
          >
        </div>
      </div>

      <br />

      <div class="form-group d-flex justify-content-between">
        <div>
          <label for="dengueProneArea"
            >Are you from a dengue prone area/ recent fogging:</label
          >
          <input
            type="text"
            class="form-control detail-input col-12"
            id="dengueProneAreaDetail"
            name="dengueProneAreaDetail"
            placeholder="If yes, please provide details"
          />
        </div>

        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="dengueProneArea" value="Yes" />
            Yes</label
          >
          <label class="btn btn-secondary">
            <input type="radio" name="dengueProneArea" value="No" id="6" />
            No</label
          >
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label for="dengueProneArea"
            >Are there any concurrent infection:</label
          ><input
            type="text"
            class="form-control detail-input col-18"
            id="concurrentDetail"
            name="concurrentDetail"
            placeholder="If yes, please provide details"
          />
        </div>

        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="concurrent" value="Yes" />
            Yes</label
          >
          <label class="btn btn-secondary">
            <input type="radio" name="concurrent" value="No" id="6" />
            No</label
          >
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Bodyache:</label>
          <input
            type="text"
            class="form-control detail-input"
            placeholder="for how many days?"
            name="bodyacheDays"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="bodyache" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="bodyache" value="no" /> No
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Headache:</label>
          <input
            type="text"
            class="form-control detail-input"
            placeholder="for how many days?"
            name="headacheDays"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="headache" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="headache" value="no" /> No
          </label>
        </div>
      </div>
      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Retro-orbital pain:</label>
          <input
            type="text"
            class="form-control detail-input col-12"
            placeholder="for how many days?"
            name="retroOrbitalPainDays"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="retroOrbitalPain" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="retroOrbitalPain" value="no" /> No
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Rash:</label>
          <input
            type="text"
            class="form-control detail-input col-12"
            placeholder="for how many days?"
            name="rashDays"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="rash" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="rash" value="no" /> No
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label for="drinkAmount">How much can you drink?</label>
          <input
            type="text"
            class="form-control detail-input col-12"
            placeholder="quantify"
            name="drinkAmount"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="drink" value="normal" /> Normal
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="drink" value="less" /> Less
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="drink" value="nil" /> Nil
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label for="urineVolume">Is there reduced urine volume?</label>
          <input
            type="text"
            class="form-control detail-input col-12"
            placeholder="quantify"
            name="urineVolumeQuantify"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="urineVolume" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="urineVolume" value="no" /> No
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <label>Can you perform usual activities?</label>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="usualActivities" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="usualActivities" value="no" /> No
          </label>
        </div>
      </div>

      <h3>Warning Sign</h3>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Vomiting?</label>
          <input
            type="text"
            class="form-control"
            placeholder="frequency/day for how many days?"
            name="vomitingFrequency"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="vomiting" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="vomiting" value="no" /> No
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Diarrhea?</label>
          <input
            type="text"
            class="form-control"
            placeholder="frequency/day for how many days?"
            name="diarrheaFrequency"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="diarrhea" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="diarrhea" value="no" /> No
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Abdominal pain?</label>
          <input
            type="text"
            class="form-control"
            placeholder="for how many days?"
            name="abdominalPainDays"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="abdominalPain" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="abdominalPain" value="no" /> No
          </label>
        </div>
      </div>

      <div class="form-group d-flex justify-content-between">
        <div>
          <label>Bleeding/bruising?</label>
          <input
            type="text"
            class="form-control"
            placeholder="for how many days?"
            name="bleedingBruisingDays"
          />
        </div>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-secondary">
            <input type="radio" name="bleedingBruising" value="yes" /> Yes
          </label>
          <label class="btn btn-secondary">
            <input type="radio" name="bleedingBruising" value="no" /> No
          </label>
        </div>
      </div>

      <h3>Vital signs</h3>
      <div>
        <div>
          <label for="vitalInput">Paste your vital signs here:</label>
          <textarea class="form-control" id="vitalInput" rows="10"></textarea>
        </div>
        <div id="resultVC"></div>
      </div>

      <div class="form-group">
        <label for="physicalInput"
          >Fill in the physical examination findings:</label
        >
        <textarea id="physicalInput" style="height: 200px">
Throat: 
Lymph node: 
CVS: 
Lungs: 
Abdomen: 
Plasma Leakage: 
Other physical findings: </textarea
        >
      </div>
      <h3>FBC Result</h3>
      <div>
        <div>
          <label for="fbcInput">Paste your FBC result details here:</label>
          <textarea class="form-control" id="fbcInput" rows="10"></textarea>
        </div>

        <div id="resultFBC"></div>
      </div>

      <h3>Dengue serology</h3>

      <div class="form-group">
        <label for="ns1">NS1:</label>
        <input type="text" class="form-control" id="ns1" name="ns1" />
      </div>

      <div class="form-group">
        <label for="igm">IgM:</label>
        <input type="text" class="form-control" id="igm" name="igm" />
      </div>

      <div class="form-group">
        <label for="igg">IgG:</label>
        <input type="text" class="form-control" id="igg" name="igg" />
      </div>

      <div class="form-group">
        <label for="otherInvestigation">Other investigation:</label>
        <input
          type="text"
          class="form-control"
          id="otherInvestigation"
          name="otherInvestigation"
        />
      </div>

      <div class="form-group">
        <label for="diagnosis">DIAGNOSIS:</label>
        <input
          type="text"
          class="form-control"
          id="diagnosis"
          name="diagnosis"
        />
      </div>

      <div class="form-group">
        <label for="ruledOut"
          >Have you ruled out other differential diagnosis? (Dengue fever/
          measles/ leptospirosis/ malaria/ ILI/ etc):</label
        >
        <input type="text" class="form-control" id="ruledOut" name="ruledOut" />
      </div>

      <div class="form-group">
        <label for="plan">Management:</label>
        <input type="text" class="form-control" id="plan" name="plan" />
      </div>

      <div class="form-group">
        <label for="notificationDate">Date of notification:</label>
        <input
          type="date"
          class="form-control"
          id="notificationDate"
          name="notificationDate"
        />
      </div>

      <div class="form-group">
        <label for="alertCardGiven">Dengue alert card given:</label>
        <input
          type="text"
          class="form-control"
          id="alertCardGiven"
          name="alertCardGiven"
        />
      </div>

      <div class="form-group">
        <label
          >*THESE ARE ALERT SIGNS AND NEED IMMEDIATE RESUS. PLEASE CONSULT
          SENIOR MO/ FMS</label
        >
      </div>

      <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    <div id="result"></div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script>
      document
        .getElementById("vitalInput")
        .addEventListener("input", analyzeVitals);
      document.getElementById("fbcInput").addEventListener("input", analyzeFBC);

      function analyzeVitals() {
        const input = document.getElementById("vitalInput").value;
        const resultvs = document.getElementById("resultVS");
        resultvs.innerHTML = "";

        if (!input.trim()) {
          resultvs.innerHTML =
            '<p class="invalid-feedback">No vital signs data detected. Please enter valid details.</p>';
          return;
        }

        const vitals = {
          bp: { regex: /bp:\s*(\d+)\/(\d+)/i },
          pr: { regex: /pr:\s*(\d+)/i, range: [60, 100], unit: "bpm" },
          t: { regex: /t:\s*(\d+\.?\d*)/i, range: [36.1, 37.2], unit: "°C" },
          pulsePressure: { calculate: true, range: [30, 50], unit: "mmHg" },
        };

        let bpSystolic, bpDiastolic;
        let foundVital = false;

        for (let key in vitals) {
          if (vitals[key].regex) {
            const match = input.match(vitals[key].regex);
            if (match) {
              foundVital = true;
              const value = parseFloat(match[1]);
              const { range, unit } = vitals[key];

              if (key === "bp") {
                bpSystolic = parseFloat(match[1]);
                bpDiastolic = parseFloat(match[2]);
                resultvs.innerHTML += `<p>Blood Pressure: ${bpSystolic}/${bpDiastolic} mmHg</p>`;
              } else {
                const isWithinRange = value >= range[0] && value <= range[1];
                resultvs.innerHTML += `
                        <p>${key.toUpperCase()}: 
                        <span class="${
                          isWithinRange ? "within-range" : "out-of-range"
                        }">
                        ${value} ${unit}</span> (Normal: ${range[0]} - ${
                  range[1]
                } ${unit})</p>`;
              }
            }
          }
        }

        if (bpSystolic && bpDiastolic) {
          foundVital = true;
          const pulsePressure = bpSystolic - bpDiastolic;
          const { range, unit } = vitals.pulsePressure;
          const isWithinRange =
            pulsePressure >= range[0] && pulsePressure <= range[1];
          resultvs.innerHTML += `
            <p>Pulse Pressure: 
            <span class="${isWithinRange ? "within-range" : "out-of-range"}">
            ${pulsePressure} ${unit}</span> (Normal: ${range[0]} - ${
            range[1]
          } ${unit})</p>`;
        }

        if (!foundVital) {
          resultvs.innerHTML =
            '<p class="invalid-feedback">No vital signs data detected. Please ensure the input contains valid vital signs details.</p>';
        }
      }

      function analyzeFBC() {
        const input = document.getElementById("fbcInput").value;
        const resultfbc = document.getElementById("resultFBC");
        resultfbc.innerHTML = "";

        if (!input.trim()) {
          resultfbc.innerHTML =
            '<p class="invalid-feedback">No FBC data detected. Please enter valid FBC details.</p>';
          return;
        }

        const tests = {
          hemoglobin: { range: [11.5, 16.5], unit: "g/dL" },
          "white blood cell": { range: [4.0, 11.0], unit: "x10" },
          platelet: { range: [150, 400], unit: "x10" },
          hematocrit: { range: [37.0, 47.0], unit: "%" },
        };

        const lines = input.toLowerCase().split("\n");
        let foundTest = false;

        for (let key in tests) {
          const regex = new RegExp(`${key}:\\s*(\\d+\\.?\\d*)`, "i");
          const match = lines.find((line) => regex.test(line));
          if (match) {
            foundTest = true;
            const value = parseFloat(match.match(regex)[1]);
            const { range, unit } = tests[key];
            const isWithinRange = value >= range[0] && value <= range[1];
            resultfbc.innerHTML += `
                    <p>${key.charAt(0).toUpperCase() + key.slice(1)}: 
                    <span class="${
                      isWithinRange ? "within-range" : "out-of-range"
                    }">
                    ${value} ${unit}</span> (Normal: ${range[0]} - ${
              range[1]
            } ${unit})</p>`;
          }
        }

        if (!foundTest) {
          resultfbc.innerHTML =
            '<p class="invalid-feedback">No FBC data detected. Please ensure the input contains valid FBC details.</p>';
        }
      }

      function toggleDetailInput(inputId, show) {
        const input = document.getElementById(inputId);
        if (show) {
          input.style.display = "block";
          input.disabled = false;
        } else {
          input.style.display = "none";
          input.disabled = true;
        }
      }

      document
        .getElementById("fever-clerking-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          const form = event.target;
          let result = "<h2>Submitted Data</h2>";
          for (let i = 0; i < form.elements.length; i++) {
            const element = form.elements[i];
            if (element.name && element.value) {
              result +=
                "<p><strong>" +
                element.name +
                ":</strong> " +
                element.value +
                "</p>";
            }
          }
          document.getElementById("result").innerHTML = result;
        });
    </script>
  </body>
</html>
